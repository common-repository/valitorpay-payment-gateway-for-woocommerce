(()=>{"use strict";var e={961:function(e,t,r){var a=this&&this.__assign||function(){return a=Object.assign||function(e){for(var t,r=1,a=arguments.length;r<a;r++)for(var n in t=arguments[r])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},a.apply(this,arguments)},n=r(83),i=r(209),o=r(664),s=r(101),c=r(788),p={},l={VISA:"visa",MASTERCARD:"mastercard",AMERICAN_EXPRESS:"american-express",DINERS_CLUB:"diners-club",DISCOVER:"discover",JCB:"jcb",UNIONPAY:"unionpay",MAESTRO:"maestro",ELO:"elo",MIR:"mir",HIPER:"hiper",HIPERCARD:"hipercard"},d=[l.VISA,l.MASTERCARD,l.AMERICAN_EXPRESS,l.DINERS_CLUB,l.DISCOVER,l.JCB,l.UNIONPAY,l.MAESTRO,l.ELO,l.MIR,l.HIPER,l.HIPERCARD],u=(0,c.clone)(d);function y(e){return p[e]||n[e]}function m(e,t){void 0===t&&(t=!1);var r=u.indexOf(e);if(!t&&-1===r)throw new Error('"'+e+'" is not a supported card type.');return r}function v(e){var t=[];if(!(0,o.isValidInputType)(e))return t;if(0===e.length)return u.map((function(e){return(0,c.clone)(y(e))}));u.forEach((function(r){var a=y(r);(0,i.addMatchingCardsToResults)(e,a,t)}));var r=(0,s.findBestMatch)(t);return r?[r]:t}v.getTypeInfo=function(e){return(0,c.clone)(y(e))},v.removeCard=function(e){var t=m(e);u.splice(t,1)},v.addCard=function(e){var t=m(e.type,!0);p[e.type]=e,-1===t&&u.push(e.type)},v.updateCard=function(e,t){var r=p[e]||n[e];if(!r)throw new Error('"'.concat(e,"\" is not a recognized type. Use `addCard` instead.'"));if(t.type&&r.type!==t.type)throw new Error("Cannot overwrite type parameter.");var i=(0,c.clone)(r);i=a(a({},i),t),p[i.type]=i},v.changeOrder=function(e,t){var r=m(e);u.splice(r,1),u.splice(t,0,e)},v.resetModifications=function(){u=(0,c.clone)(d),p={}},v.types=l,e.exports=v},209:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.addMatchingCardsToResults=void 0;var a=r(788),n=r(256);t.addMatchingCardsToResults=function(e,t,r){var i,o;for(i=0;i<t.patterns.length;i++){var s=t.patterns[i];if((0,n.matches)(e,s)){var c=(0,a.clone)(t);o=Array.isArray(s)?String(s[0]).length:String(s).length,e.length>=o&&(c.matchStrength=o),r.push(c);break}}}},83:e=>{e.exports={visa:{niceType:"Visa",type:"visa",patterns:[4],gaps:[4,8,12],lengths:[16,18,19],code:{name:"CVV",size:3}},mastercard:{niceType:"Mastercard",type:"mastercard",patterns:[[51,55],[2221,2229],[223,229],[23,26],[270,271],2720],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},"american-express":{niceType:"American Express",type:"american-express",patterns:[34,37],gaps:[4,10],lengths:[15],code:{name:"CID",size:4}},"diners-club":{niceType:"Diners Club",type:"diners-club",patterns:[[300,305],36,38,39],gaps:[4,10],lengths:[14,16,19],code:{name:"CVV",size:3}},discover:{niceType:"Discover",type:"discover",patterns:[6011,[644,649],65],gaps:[4,8,12],lengths:[16,19],code:{name:"CID",size:3}},jcb:{niceType:"JCB",type:"jcb",patterns:[2131,1800,[3528,3589]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVV",size:3}},unionpay:{niceType:"UnionPay",type:"unionpay",patterns:[620,[62100,62182],[62184,62187],[62185,62197],[62200,62205],[622010,622999],622018,[62207,62209],[623,626],6270,6272,6276,[627700,627779],[627781,627799],[6282,6289],6291,6292,810,[8110,8131],[8132,8151],[8152,8163],[8164,8171]],gaps:[4,8,12],lengths:[14,15,16,17,18,19],code:{name:"CVN",size:3}},maestro:{niceType:"Maestro",type:"maestro",patterns:[493698,[5e5,504174],[504176,506698],[506779,508999],[56,59],63,67,6],gaps:[4,8,12],lengths:[12,13,14,15,16,17,18,19],code:{name:"CVC",size:3}},elo:{niceType:"Elo",type:"elo",patterns:[401178,401179,438935,457631,457632,431274,451416,457393,504175,[506699,506778],[509e3,509999],627780,636297,636368,[650031,650033],[650035,650051],[650405,650439],[650485,650538],[650541,650598],[650700,650718],[650720,650727],[650901,650978],[651652,651679],[655e3,655019],[655021,655058]],gaps:[4,8,12],lengths:[16],code:{name:"CVE",size:3}},mir:{niceType:"Mir",type:"mir",patterns:[[2200,2204]],gaps:[4,8,12],lengths:[16,17,18,19],code:{name:"CVP2",size:3}},hiper:{niceType:"Hiper",type:"hiper",patterns:[637095,63737423,63743358,637568,637599,637609,637612],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}},hipercard:{niceType:"Hipercard",type:"hipercard",patterns:[606282],gaps:[4,8,12],lengths:[16],code:{name:"CVC",size:3}}}},788:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.clone=void 0,t.clone=function(e){return e?JSON.parse(JSON.stringify(e)):null}},101:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.findBestMatch=void 0,t.findBestMatch=function(e){return function(e){var t=e.filter((function(e){return e.matchStrength})).length;return t>0&&t===e.length}(e)?e.reduce((function(e,t){return e?Number(e.matchStrength)<Number(t.matchStrength)?t:e:t})):null}},664:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isValidInputType=void 0,t.isValidInputType=function(e){return"string"==typeof e||e instanceof String}},256:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.matches=void 0,t.matches=function(e,t){return Array.isArray(t)?function(e,t,r){var a=String(t).length,n=e.substr(0,a),i=parseInt(n,10);return t=parseInt(String(t).substr(0,n.length),10),r=parseInt(String(r).substr(0,n.length),10),i>=t&&i<=r}(e,t[0],t[1]):function(e,t){return(t=String(t)).substring(0,e.length)===e.substring(0,t.length)}(e,t)}},20:(e,t,r)=>{var a=r(609),n=Symbol.for("react.element"),i=(Symbol.for("react.fragment"),Object.prototype.hasOwnProperty),o=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,s={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,r){var a,c={},p=null,l=null;for(a in void 0!==r&&(p=""+r),void 0!==t.key&&(p=""+t.key),void 0!==t.ref&&(l=t.ref),t)i.call(t,a)&&!s.hasOwnProperty(a)&&(c[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===c[a]&&(c[a]=t[a]);return{$$typeof:n,type:e,key:p,ref:l,props:c,_owner:o.current}}t.jsx=c,t.jsxs=c},848:(e,t,r)=>{e.exports=r(20)},609:e=>{e.exports=window.React}},t={};function r(a){var n=t[a];if(void 0!==n)return n.exports;var i=t[a]={exports:{}};return e[a].call(i.exports,i,i.exports,r),i.exports}r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var a in t)r.o(t,a)&&!r.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);const a=window.wp.i18n,n=window.wc.wcBlocksRegistry,i=window.wp.htmlEntities,o=window.wp.element,s=window.wc.wcSettings,c=window.wc.blocksCheckout;var p,l=r(961),d=r.n(l),u=r(848);const{useSelect:y}=window.wp.data,{CHECKOUT_STORE_KEY:m}=window.wc.wcBlocksData,{PAYMENT_STORE_KEY:v}=window.wc.wcBlocksData,f=(0,s.getPaymentMethodData)("valitorpay",{}),g=(0,a.__)("Valitorpay","valitorpay-payment-gateway-for-woocommerce"),h=(0,i.decodeEntities)(f?.title||"")||g,w=()=>(0,i.decodeEntities)(f.description||""),C=()=>{if(f.testmode){const e=(0,a.__)("In test mode, you can use cardNumbers: 5526830589243348(MasterCard), 4921810880068101(Visa), 379999835077294(Amex)","valitorpay-payment-gateway-for-woocommerce");return(0,u.jsx)("div",{class:"valitorpay-testmode-notice",children:(0,u.jsx)("i",{children:e})})}},_=e=>{const[t,r]=(0,o.useState)(""),[n,i]=(0,o.useState)(""),[s,p]=(0,o.useState)(""),{eventRegistration:l,emitResponse:y}=e,{onPaymentSetup:m}=l;return(0,o.useEffect)((()=>{const e=m((async()=>{const e={};return t&&(e["valitorpay-card-number"]=t),n&&(e["valitorpay-card-expiry"]=n),s&&(e["valitorpay-card-cvc"]=s),0!==Object.keys(e).length?{type:y.responseTypes.SUCCESS,meta:{paymentMethodData:e}}:{type:y.responseTypes.ERROR,message:"There was an error"}}));return()=>{e()}}),[y.responseTypes.ERROR,y.responseTypes.SUCCESS,m,t,n,s]),[(0,u.jsx)(w,{}),(0,u.jsx)(C,{}),(0,u.jsxs)("div",{className:"valitorpay-fields wc-block-card-elements",children:[(0,u.jsx)("div",{className:"valitorpay-payment-field valitorpay-payment-card wc-block-gateway-container wc-card-number-element",children:(0,u.jsx)(c.ValidatedTextInput,{id:"valitorpay-card-number",name:"valitorpay-card-number",type:"tel",required:!0,class:"valitorpay-input valitorpay-card-input",label:(0,a.__)("Card number","valitorpay-payment-gateway-for-woocommerce"),inputmode:"numeric",maxlength:"19",autocomplete:"cc-number",value:t,onChange:e=>{e?/^-?\d+$/.test(e)?r(e):r(null!=t?t:""):r("")},customValidation:(e,t)=>{if(e.value&&parseInt(e.value.length)>4){const t=d()(e.value);if(1==t.length){const r=t[0].lengths;if(parseInt(r[0])<=parseInt(e.value.length))return!0}}return e.setCustomValidity((0,a.__)("Please enter a valid Card number","valitorpay-payment-gateway-for-woocommerce")),!1}})}),(0,u.jsx)("div",{className:"valitorpay-payment-field valitorpay-payment-field-c-expiry wc-block-gateway-container wc-card-expiry-element",children:(0,u.jsx)(c.ValidatedTextInput,{id:"valitorpay-card-expiry",type:"tel",required:!0,class:"valitorpay-input valitorpay-card-expiry-input",label:(0,a.__)("Expiry Date","valitorpay-payment-gateway-for-woocommerce"),value:n,maxlength:"5",onChange:e=>{const t=e.split("/"),r=e.length;if(n.length>r){var a;2==r&&(e=e.slice(0,-1)),i(null!==(a=e)&&void 0!==a?a:"")}else{let a=!0;var o;t.forEach(((e,t)=>{a=!!/^-?\d+$/.test(e)&&(0!==t||e<=12&&"00"!==e)})),2==r&&(e+="/"),i(a?null!==(o=e)&&void 0!==o?o:"":null!=n?n:"")}},customValidation:e=>{if(e.value&&parseInt(e.value.length)>4){const t=e.value.split("/"),r=new Date,a=r.getMonth(),n=r.getFullYear(),i=parseInt("20"+t[1]),o=parseInt(t[0]);if(i>n){if(o>0&&o<=12)return!0}else if(i==n&&o>=a+1&&o<=12)return!0}return e.setCustomValidity((0,a.__)("Please enter a valid Expiry (MM/YY)","valitorpay-payment-gateway-for-woocommerce")),!1}})}),(0,u.jsx)("div",{className:"valitorpay-payment-field valitorpay-payment-field-cvc wc-block-gateway-container wc-card-cvc-element",children:(0,u.jsx)(c.ValidatedTextInput,{id:"valitorpay-card-cvc",type:"tel",name:"valitorpay-card-cvc",required:!0,class:"valitorpay-input valitorpay-card-cvc-input",autocorrect:"no",spellcheck:"no",label:(0,a.__)("Card code","valitorpay-payment-gateway-for-woocommerce"),maxlength:"4",value:s,onChange:e=>{/^-?\d+$/.test(e)?p(null!=e?e:""):p(null!=s?s:"")}})})]})]},E=e=>{const{PaymentMethodLabel:t}=e.components;return(0,u.jsx)(t,{text:h})},b={name:"valitorpay",label:(0,u.jsx)(E,{}),content:(0,u.jsx)(_,{}),edit:(0,u.jsx)(_,{}),canMakePayment:()=>!0,ariaLabel:h,supports:{features:null!==(p=f?.supports)&&void 0!==p?p:[]}};(0,n.registerPaymentMethod)(b)})();